local ScreenGui = Instance.new("ScreenGui")
local BarFrameDragable = Instance.new("Frame")
local Interface = Instance.new("Frame")
local MiscInterface = Instance.new("Frame")
local Aimbot = Instance.new("TextButton")
local Misc = Instance.new("TextButton")
local Visuals = Instance.new("TextButton")
local VisualsInterface = Instance.new("Frame")
local ButtonChams = Instance.new("TextButton")
local EnableChams = Instance.new("TextLabel")
local AimbotInterface = Instance.new("Frame")
local ButtonAimbot = Instance.new("TextButton")
local EnableAimbot = Instance.new("TextLabel")
local BoxSmooth = Instance.new("TextBox")
local TextBoxSmooth = Instance.new("TextLabel")
local BoxFOV = Instance.new("TextBox")
local TextBoxFOV = Instance.new("TextLabel")
local ButtonTeamCheck = Instance.new("TextButton")
local EnableTeamCheck = Instance.new("TextLabel")
local ButtonRay = Instance.new("TextButton")
local EnableUseRayWithIgnoreList = Instance.new("TextLabel")
local TiltleGui = Instance.new("TextLabel")

ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.DisplayOrder = 100

BarFrameDragable.Name = "BarFrameDragable"
BarFrameDragable.Parent = ScreenGui
BarFrameDragable.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
BarFrameDragable.BorderColor3 = Color3.fromRGB(0, 0, 0)
BarFrameDragable.BorderSizePixel = 0
BarFrameDragable.Position = UDim2.new(0.304980129, 0, 0.322222233, 0)
BarFrameDragable.Size = UDim2.new(0, 431, 0, 20)

Interface.Name = "Interface"
Interface.Parent = BarFrameDragable
Interface.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Interface.BorderColor3 = Color3.fromRGB(0, 0, 0)
Interface.BorderSizePixel = 0
Interface.Position = UDim2.new(0, 0, 1, 0)
Interface.Size = UDim2.new(0, 431, 0, 219)

MiscInterface.Name = "MiscInterface"
MiscInterface.Parent = Interface
MiscInterface.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
MiscInterface.BorderColor3 = Color3.fromRGB(0, 0, 0)
MiscInterface.BorderSizePixel = 0
MiscInterface.Position = UDim2.new(0.0390000008, 0, 0.280000001, 0)
MiscInterface.Size = UDim2.new(0, 395, 0, 146)

Aimbot.Name = "Aimbot"
Aimbot.Parent = Interface
Aimbot.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
Aimbot.BorderColor3 = Color3.fromRGB(0, 0, 0)
Aimbot.BorderSizePixel = 0
Aimbot.Position = UDim2.new(0, 17, 0, 11)
Aimbot.Size = UDim2.new(0, 128, 0, 38)
Aimbot.Font = Enum.Font.SourceSansBold
Aimbot.Text = "Aimbot"
Aimbot.TextColor3 = Color3.fromRGB(255, 255, 255)
Aimbot.TextSize = 20.000
Aimbot.TextStrokeTransparency = 0.000

Misc.Name = "Misc"
Misc.Parent = Interface
Misc.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
Misc.BorderColor3 = Color3.fromRGB(0, 0, 0)
Misc.BorderSizePixel = 0
Misc.Position = UDim2.new(0, 285, 0, 11)
Misc.Size = UDim2.new(0, 128, 0, 38)
Misc.Font = Enum.Font.SourceSansBold
Misc.Text = "Misc"
Misc.TextColor3 = Color3.fromRGB(255, 255, 255)
Misc.TextSize = 20.000
Misc.TextStrokeTransparency = 0.000

Visuals.Name = "Visuals"
Visuals.Parent = Interface
Visuals.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
Visuals.BorderColor3 = Color3.fromRGB(0, 0, 0)
Visuals.BorderSizePixel = 0
Visuals.Position = UDim2.new(0, 151, 0, 11)
Visuals.Size = UDim2.new(0, 128, 0, 38)
Visuals.Font = Enum.Font.SourceSansBold
Visuals.Text = "Visuals"
Visuals.TextColor3 = Color3.fromRGB(255, 255, 255)
Visuals.TextSize = 20.000
Visuals.TextStrokeTransparency = 0.000

VisualsInterface.Name = "VisualsInterface"
VisualsInterface.Parent = Interface
VisualsInterface.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
VisualsInterface.BorderColor3 = Color3.fromRGB(0, 0, 0)
VisualsInterface.BorderSizePixel = 0
VisualsInterface.Position = UDim2.new(0.0394431539, 0, 0.279757857, 0)
VisualsInterface.Size = UDim2.new(0, 395, 0, 146)

ButtonChams.Name = "ButtonChams"
ButtonChams.Parent = VisualsInterface
ButtonChams.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
ButtonChams.BorderColor3 = Color3.fromRGB(152, 59, 5)
ButtonChams.BorderSizePixel = 0
ButtonChams.Position = UDim2.new(0, 3, 0, 7)
ButtonChams.Size = UDim2.new(0, 19, 0, 19)
ButtonChams.Font = Enum.Font.SourceSans
ButtonChams.Text = ""
ButtonChams.TextColor3 = Color3.fromRGB(0, 0, 0)
ButtonChams.TextSize = 14.000
ButtonChams.TextStrokeColor3 = Color3.fromRGB(152, 59, 5)

EnableChams.Name = "EnableChams"
EnableChams.Parent = ButtonChams
EnableChams.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
EnableChams.BackgroundTransparency = 1.000
EnableChams.BorderColor3 = Color3.fromRGB(0, 0, 0)
EnableChams.BorderSizePixel = 0
EnableChams.Position = UDim2.new(1.68421054, 0, -0.0498400219, 0)
EnableChams.Size = UDim2.new(0, 82, 0, 18)
EnableChams.Font = Enum.Font.SourceSansBold
EnableChams.Text = "Enable Chams"
EnableChams.TextColor3 = Color3.fromRGB(255, 255, 255)
EnableChams.TextSize = 18.000

AimbotInterface.Name = "AimbotInterface"
AimbotInterface.Parent = Interface
AimbotInterface.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
AimbotInterface.BorderColor3 = Color3.fromRGB(0, 0, 0)
AimbotInterface.BorderSizePixel = 0
AimbotInterface.Position = UDim2.new(0.0390000008, 0, 0.280000001, 0)
AimbotInterface.Size = UDim2.new(0, 395, 0, 146)

ButtonAimbot.Name = "ButtonAimbot"
ButtonAimbot.Parent = AimbotInterface
ButtonAimbot.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
ButtonAimbot.BorderColor3 = Color3.fromRGB(152, 59, 5)
ButtonAimbot.BorderSizePixel = 0
ButtonAimbot.Position = UDim2.new(0, 3, 0, 7)
ButtonAimbot.Size = UDim2.new(0, 19, 0, 19)
ButtonAimbot.Font = Enum.Font.SourceSans
ButtonAimbot.Text = ""
ButtonAimbot.TextColor3 = Color3.fromRGB(0, 0, 0)
ButtonAimbot.TextSize = 14.000
ButtonAimbot.TextStrokeColor3 = Color3.fromRGB(152, 59, 5)

EnableAimbot.Name = "EnableAimbot"
EnableAimbot.Parent = ButtonAimbot
EnableAimbot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
EnableAimbot.BackgroundTransparency = 1.000
EnableAimbot.BorderColor3 = Color3.fromRGB(0, 0, 0)
EnableAimbot.BorderSizePixel = 0
EnableAimbot.Position = UDim2.new(1.69426525, 0, -0.0498400219, 0)
EnableAimbot.Size = UDim2.new(0, 81, 0, 18)
EnableAimbot.Font = Enum.Font.SourceSansBold
EnableAimbot.Text = "Enable Aimbot"
EnableAimbot.TextColor3 = Color3.fromRGB(255, 255, 255)
EnableAimbot.TextSize = 18.000

BoxSmooth.Name = "BoxSmooth"
BoxSmooth.Parent = AimbotInterface
BoxSmooth.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
BoxSmooth.BorderColor3 = Color3.fromRGB(255, 255, 255)
BoxSmooth.Position = UDim2.new(0, 3, 0, 45)
BoxSmooth.Size = UDim2.new(0, 39, 0, 26)
BoxSmooth.Visible = false
BoxSmooth.Font = Enum.Font.SourceSans
BoxSmooth.Text = ""
BoxSmooth.TextColor3 = Color3.fromRGB(255, 255, 255)
BoxSmooth.TextSize = 15.000

TextBoxSmooth.Name = "TextBoxSmooth"
TextBoxSmooth.Parent = BoxSmooth
TextBoxSmooth.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TextBoxSmooth.BackgroundTransparency = 1.000
TextBoxSmooth.BorderColor3 = Color3.fromRGB(0, 0, 0)
TextBoxSmooth.BorderSizePixel = 0
TextBoxSmooth.Position = UDim2.new(1.12820518, 0, 0.142467797, 0)
TextBoxSmooth.Size = UDim2.new(0, 57, 0, 18)
TextBoxSmooth.Font = Enum.Font.SourceSansBold
TextBoxSmooth.Text = "Smooth"
TextBoxSmooth.TextColor3 = Color3.fromRGB(255, 255, 255)
TextBoxSmooth.TextSize = 18.000

BoxFOV.Name = "BoxFOV"
BoxFOV.Parent = AimbotInterface
BoxFOV.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
BoxFOV.BorderColor3 = Color3.fromRGB(255, 255, 255)
BoxFOV.Position = UDim2.new(0, 3, 0, 90)
BoxFOV.Size = UDim2.new(0, 39, 0, 26)
BoxFOV.Visible = false
BoxFOV.Font = Enum.Font.SourceSans
BoxFOV.Text = ""
BoxFOV.TextColor3 = Color3.fromRGB(255, 255, 255)
BoxFOV.TextSize = 15.000

TextBoxFOV.Name = "TextBoxFOV"
TextBoxFOV.Parent = BoxFOV
TextBoxFOV.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TextBoxFOV.BackgroundTransparency = 1.000
TextBoxFOV.BorderColor3 = Color3.fromRGB(0, 0, 0)
TextBoxFOV.BorderSizePixel = 0
TextBoxFOV.Position = UDim2.new(1.12820518, 0, 0.142467797, 0)
TextBoxFOV.Size = UDim2.new(0, 30, 0, 18)
TextBoxFOV.Font = Enum.Font.SourceSansBold
TextBoxFOV.Text = "FOV"
TextBoxFOV.TextColor3 = Color3.fromRGB(255, 255, 255)
TextBoxFOV.TextSize = 18.000

ButtonTeamCheck.Name = "ButtonTeamCheck"
ButtonTeamCheck.Parent = AimbotInterface
ButtonTeamCheck.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
ButtonTeamCheck.BorderColor3 = Color3.fromRGB(152, 59, 5)
ButtonTeamCheck.BorderSizePixel = 0
ButtonTeamCheck.Position = UDim2.new(0, 137, 0, 7)
ButtonTeamCheck.Size = UDim2.new(0, 19, 0, 19)
ButtonTeamCheck.Visible = false
ButtonTeamCheck.Font = Enum.Font.SourceSans
ButtonTeamCheck.Text = ""
ButtonTeamCheck.TextColor3 = Color3.fromRGB(0, 0, 0)
ButtonTeamCheck.TextSize = 14.000
ButtonTeamCheck.TextStrokeColor3 = Color3.fromRGB(152, 59, 5)

EnableTeamCheck.Name = "EnableTeamCheck"
EnableTeamCheck.Parent = ButtonTeamCheck
EnableTeamCheck.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
EnableTeamCheck.BackgroundTransparency = 1.000
EnableTeamCheck.BorderColor3 = Color3.fromRGB(0, 0, 0)
EnableTeamCheck.BorderSizePixel = 0
EnableTeamCheck.Position = UDim2.new(1, 0, -0.0498400219, 0)
EnableTeamCheck.Size = UDim2.new(0, 85, 0, 18)
EnableTeamCheck.Font = Enum.Font.SourceSansBold
EnableTeamCheck.Text = "TeamCheck"
EnableTeamCheck.TextColor3 = Color3.fromRGB(255, 255, 255)
EnableTeamCheck.TextSize = 18.000

ButtonRay.Name = "ButtonRay"
ButtonRay.Parent = AimbotInterface
ButtonRay.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
ButtonRay.BorderColor3 = Color3.fromRGB(152, 59, 5)
ButtonRay.BorderSizePixel = 0
ButtonRay.Position = UDim2.new(0, 137, 0, 45)
ButtonRay.Size = UDim2.new(0, 19, 0, 19)
ButtonRay.Visible = false
ButtonRay.Font = Enum.Font.SourceSans
ButtonRay.Text = ""
ButtonRay.TextColor3 = Color3.fromRGB(0, 0, 0)
ButtonRay.TextSize = 14.000
ButtonRay.TextStrokeColor3 = Color3.fromRGB(152, 59, 5)

EnableUseRayWithIgnoreList.Name = "EnableUseRayWithIgnoreList"
EnableUseRayWithIgnoreList.Parent = ButtonRay
EnableUseRayWithIgnoreList.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
EnableUseRayWithIgnoreList.BackgroundTransparency = 1.000
EnableUseRayWithIgnoreList.BorderColor3 = Color3.fromRGB(0, 0, 0)
EnableUseRayWithIgnoreList.BorderSizePixel = 0
EnableUseRayWithIgnoreList.Position = UDim2.new(1, 0, -0.0498400219, 0)
EnableUseRayWithIgnoreList.Size = UDim2.new(0, 36, 0, 18)
EnableUseRayWithIgnoreList.Font = Enum.Font.SourceSansBold
EnableUseRayWithIgnoreList.Text = "Ray"
EnableUseRayWithIgnoreList.TextColor3 = Color3.fromRGB(255, 255, 255)
EnableUseRayWithIgnoreList.TextSize = 18.000

TiltleGui.Name = "TiltleGui"
TiltleGui.Parent = BarFrameDragable
TiltleGui.Active = true
TiltleGui.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TiltleGui.BackgroundTransparency = 1.000
TiltleGui.BorderColor3 = Color3.fromRGB(0, 0, 0)
TiltleGui.BorderSizePixel = 0
TiltleGui.Position = UDim2.new(0, 0, -0.100000001, 0)
TiltleGui.Size = UDim2.new(0, 162, 0, 22)
TiltleGui.Font = Enum.Font.SourceSansBold
TiltleGui.Text = "MIDNIGHT ROBLOX 🎃"
TiltleGui.TextColor3 = Color3.fromRGB(255, 255, 255)
TiltleGui.TextSize = 19.000
TiltleGui.TextStrokeTransparency = 0.000
----------------------------------------------------------------------------------------
--ColorSelectionButton
----------------------------------------------------------------------------------------
local Aimbot = ScreenGui:WaitForChild("BarFrameDragable"):WaitForChild("Interface"):WaitForChild("Aimbot")
local Visuals = ScreenGui:WaitForChild("BarFrameDragable"):WaitForChild("Interface"):WaitForChild("Visuals")
local Misc = ScreenGui:WaitForChild("BarFrameDragable"):WaitForChild("Interface"):WaitForChild("Misc")

local boutonSelectionne = nil

local function ChangerCouleur(bouton)
	if boutonSelectionne then
		boutonSelectionne.BackgroundColor3 = Color3.fromRGB(107, 46, 3) 
	end

	boutonSelectionne = bouton

	boutonSelectionne.BackgroundColor3 = Color3.fromRGB(152, 59, 5) 
end

Aimbot.MouseButton1Click:Connect(function()
	ChangerCouleur(Aimbot)
end)

Visuals.MouseButton1Click:Connect(function()
	ChangerCouleur(Visuals)
end)

Misc.MouseButton1Click:Connect(function()
	ChangerCouleur(Misc)
end)

ChangerCouleur(Aimbot)
----------------------------------------------------------------------------------------
--BarFrameDragable Drag
----------------------------------------------------------------------------------------
local UserInputService = game:GetService("UserInputService")
local dragging
local dragStart
local startPos

local function updateDrag(input)
	local delta = input.Position - dragStart
	BarFrameDragable.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

BarFrameDragable.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = BarFrameDragable.Position

		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
		updateDrag(input)
	end
end)
----------------------------------------------------------------------------------------
--FrameInterface
----------------------------------------------------------------------------------------
-- Variable pour suivre l'état de visibilité
local aimbotVisible = true -- Par défaut, AimbotInterface est visible
local visualsVisible = false -- Par défaut, VisualsInterface est cachée
local miscVisible = false -- Par défaut, MiscInterface est cachée

-- Assurez-vous que les interfaces que vous voulez cacher sont initialisées avec la visibilité à false
VisualsInterface.Visible = visualsVisible
MiscInterface.Visible = miscVisible

-- ... (le reste du code)

-- Ajoutez des gestionnaires d'événements pour les boutons Aimbot, Visuals et Misc
Aimbot.MouseButton1Click:Connect(function()
	-- Basculer l'état de visibilité d'AimbotInterface
	aimbotVisible = true
	AimbotInterface.Visible = aimbotVisible
	-- Assurez-vous que VisualsInterface et MiscInterface sont cachées
	visualsVisible = false
	VisualsInterface.Visible = visualsVisible
	miscVisible = false
	MiscInterface.Visible = miscVisible
end)

Visuals.MouseButton1Click:Connect(function()
	-- Basculer l'état de visibilité de VisualsInterface
	visualsVisible = true
	VisualsInterface.Visible = visualsVisible
	-- Assurez-vous que AimbotInterface et MiscInterface sont cachées
	aimbotVisible = false
	AimbotInterface.Visible = aimbotVisible
	miscVisible = false
	MiscInterface.Visible = miscVisible
end)

Misc.MouseButton1Click:Connect(function()
	-- Basculer l'état de visibilité de MiscInterface
	miscVisible = true
	MiscInterface.Visible = miscVisible
	-- Assurez-vous que AimbotInterface et VisualsInterface sont cachées
	aimbotVisible = false
	AimbotInterface.Visible = aimbotVisible
	visualsVisible = false
	VisualsInterface.Visible = visualsVisible
end)
----------------------------------------------------------------------------------------
--BorderSizeButtonESP
----------------------------------------------------------------------------------------
local buttonState = "normal" -- Variable pour suivre l'état du bouton

-- Vous pouvez ajouter un gestionnaire d'événements pour le clic sur Button1
ButtonChams.MouseButton1Click:Connect(function()
	if buttonState == "normal" then
		-- Changez la couleur de fond du bouton en la couleur souhaitée (#4692bb)
		ButtonChams.BackgroundColor3 = Color3.new(0.419608, 0.180392, 0.0117647)
		ButtonChams.BorderColor3 = Color3.new(1, 1, 1) -- Définir la couleur de la bordure
		ButtonChams.BorderSizePixel = 2.5 -- Définir la taille de la bordure
		buttonState = "clicked" -- Mettez à jour l'état du bouton
	else
		-- Revenez à la couleur d'origine du bouton
		ButtonChams.BackgroundColor3 = Color3.fromRGB(107, 46, 3)
		ButtonChams.BorderColor3 = Color3.fromRGB(0, 0, 0) -- Réinitialiser la couleur de la bordure
		ButtonChams.BorderSizePixel = 0 -- Réinitialiser la taille de la bordure
		buttonState = "normal" -- Mettez à jour l'état du bouton
	end
end)
----------------------------------------------------------------------------------------
--HideGui INSERT
----------------------------------------------------------------------------------------
local isInterfaceVisible = true

local function toggleInterface()
	isInterfaceVisible = not isInterfaceVisible
	BarFrameDragable.Visible = isInterfaceVisible
end

local UserInputService = game:GetService("UserInputService")

UserInputService.InputBegan:Connect(function(input, isProcessed)
	if not isProcessed and input.KeyCode == Enum.KeyCode.Insert then
		toggleInterface()
	end
end)
----------------------------------------------------------------------------------------
--Chams
----------------------------------------------------------------------------------------
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local playerNames = {}

local isHighlightEnabled = false

local function toggleHighlight()
	isHighlightEnabled = not isHighlightEnabled

	for _, playerName in ipairs(playerNames) do
		local player = Players:FindFirstChild(playerName)
		if player and player.Character then
			local highlight = player.Character:FindFirstChild("Highlight")
			if highlight then
				highlight.Enabled = isHighlightEnabled
			end
		end
	end
end

ButtonChams.MouseButton1Click:Connect(toggleHighlight)

local function updateHighlightColor(player)
	local highlight = player.Character:FindFirstChild("Highlight")
	if highlight then
		local team = player.Team
		if team then
			local teamColor = team.TeamColor.Color
			highlight.FillColor = teamColor

			local outlineColor = Color3.new(
				teamColor.R + 0.5, -- Red
				teamColor.G + 0.5, -- Green
				teamColor.B + 0.5  -- Blue
			)
			highlight.OutlineColor = outlineColor
		else
			-- Default color
			highlight.FillColor = Color3.new(0, 255, 0)
			highlight.OutlineColor = Color3.new(255, 0, 0)
		end
	end
end

local function setupPlayer(player)
	if player ~= game.Players.LocalPlayer and not player.Character:FindFirstChild("Highlight") then
		local Highlight = Instance.new("Highlight")
		Highlight.Parent = player.Character
		Highlight.FillTransparency = 0
		Highlight.Enabled = isHighlightEnabled

		updateHighlightColor(player)  -- Set initial color

		-- Listen to team changes
		player:GetPropertyChangedSignal("Team"):Connect(function()
			updateHighlightColor(player)
		end)
	end
end

local function updatePlayerList()
	local playerList = Players:GetPlayers()
	playerNames = {}

	for _, player in pairs(playerList) do
		table.insert(playerNames, player.Name)
		setupPlayer(player)
	end
end

RunService.Heartbeat:Connect(updatePlayerList)
updatePlayerList()

Players.PlayerAdded:Connect(function(player)
	setupPlayer(player)
end)
----------------------------------------------------------------------------------------
--Aimbot
----------------------------------------------------------------------------------------
local dwCamera = game.Workspace.CurrentCamera
local dwRunService = game:GetService("RunService")
local dwUIs = game:GetService("UserInputService")
local dwEntities = game:GetService("Players")
local dwLocalPlayer = dwEntities.LocalPlayer

local settings = {
	AimbotEnabled = false, 
	AimbotAiming = false,
	AimbotAimPart = "Head",
	AimbotTeamCheck = false,
	FOVAngle = 120,
	LockedTarget = nil,
	UseRayWithIgnoreList = true,
	AimbotSmoothness = 1,
}

-- Maintenant, nous utilisons la touche "Shift" pour activer/désactiver l'aimbot.
dwUIs.InputBegan:Connect(function(input, isProcessed)
	if input.KeyCode == Enum.KeyCode.LeftShift and settings.AimbotEnabled then
		settings.AimbotAiming = true
	end
end)

dwUIs.InputEnded:Connect(function(input, isProcessed)
	if input.KeyCode == Enum.KeyCode.LeftShift then
		settings.AimbotAiming = false
		settings.LockedTarget = nil
	end
end)

function IsInFOV(targetPos, cameraCFrame, fovAngle)
	local cameraLook = cameraCFrame.lookVector
	local targetDir = (targetPos - cameraCFrame.p).unit
	local dot = cameraLook:Dot(targetDir)
	local angle = math.deg(math.acos(dot))
	return angle <= fovAngle / 2
end

function IsVisible(cframe, part)
	if settings.UseRayWithIgnoreList then
		local origin = dwCamera.CFrame.p
		local direction = part.Position - origin
		local ray = Ray.new(origin, direction)
		local hit, hitPoint = game.Workspace:FindPartOnRayWithIgnoreList(ray, {dwLocalPlayer.Character, dwLocalPlayer.Character.HumanoidRootPart})
		return hit and hit:IsDescendantOf(part.Parent)
	else
		return true
	end
end

dwRunService.RenderStepped:Connect(function()
	local dist = math.huge
	local closest_char = nil
	local dwHouse = dwLocalPlayer:GetMouse()

	if settings.AimbotAiming then
		for _, v in pairs(dwEntities:GetPlayers()) do
			if v ~= dwLocalPlayer and v.Character and v.Character:FindFirstChild("HumanoidRootPart") and v.Character:FindFirstChild("Humanoid") and v.Character:FindFirstChild("Humanoid").Health > 0 then
				if settings.AimbotTeamCheck then
					if v.Team == dwLocalPlayer.Team then
						continue
					end
				end

				local char = v.Character
				local char_part_pos = char[settings.AimbotAimPart].Position

				if IsInFOV(char_part_pos, dwCamera.CFrame, settings.FOVAngle) and IsVisible(dwCamera.CFrame, char[settings.AimbotAimPart]) then
					local is_onscreen = dwCamera:WorldToViewportPoint(char_part_pos)
					local mag = (Vector2.new(dwHouse.X, dwHouse.Y) - Vector2.new(is_onscreen.X, is_onscreen.Y)).Magnitude

					if mag < dist then
						dist = mag
						closest_char = char
					end
				end
			end
		end
	end

	if closest_char and closest_char:FindFirstChild("HumanoidRootPart") and closest_char:FindFirstChild("Humanoid") and closest_char:FindFirstChild("Humanoid").Health > 0 then
		if settings.LockedTarget then
			if settings.LockedTarget:FindFirstChild("HumanoidRootPart") and settings.LockedTarget:FindFirstChild("Humanoid") and settings.LockedTarget:FindFirstChild("Humanoid").Health > 0 then
				closest_char = settings.LockedTarget
			else
				settings.LockedTarget = nil
			end
		else
			settings.LockedTarget = closest_char
		end

		local newCFrame = CFrame.new(dwCamera.CFrame.Position, closest_char[settings.AimbotAimPart].Position)
		dwCamera.CFrame = dwCamera.CFrame:Lerp(newCFrame, settings.AimbotSmoothness)
	end
end)
-------------------------------------------------------------------------------------------------
--TextBoxSmooth
-------------------------------------------------------------------------------------------------
BoxSmooth.MaxVisibleGraphemes = 4

BoxSmooth:GetPropertyChangedSignal("Text"):Connect(function()
	local num = tonumber(BoxSmooth.Text)
	if num and num > 1 then
		BoxSmooth.Text = "1"
	elseif string.len(BoxSmooth.Text) > 4 then 
		BoxSmooth.Text = string.sub(BoxSmooth.Text, 1, 4)
	end
end)

BoxSmooth.FocusLost:Connect(function()
	local newSmoothness = tonumber(BoxSmooth.Text)
	if newSmoothness then
		settings.AimbotSmoothness = newSmoothness
	else
		BoxSmooth.Text = tostring(settings.AimbotSmoothness)
	end
end)
-------------------------------------------------------------------------------------------------
--TextBoxFOV
-------------------------------------------------------------------------------------------------
BoxFOV.MaxVisibleGraphemes = 4

BoxFOV:GetPropertyChangedSignal("Text"):Connect(function()
	local num = tonumber(BoxFOV.Text)
	if num and num > 360 then
		BoxFOV.Text = "1"
	elseif string.len(BoxFOV.Text) > 4 then 
		BoxFOV.Text = string.sub(BoxFOV.Text, 1, 3)
	end
end)

BoxFOV.FocusLost:Connect(function()
	local newFOVAngle = tonumber(BoxFOV.Text)
	if newFOVAngle then
		settings.FOVAngle = newFOVAngle
	else
		BoxFOV.Text = tostring(settings.FOVAngle)
	end
end)
-------------------------------------------------------------------------------------------------
--ClickButtonAimbotAiming
-------------------------------------------------------------------------------------------------
ButtonTeamCheck.MouseButton1Click:Connect(function()
	settings.AimbotTeamCheck = not settings.AimbotTeamCheck
end)
----------------------------------------------------------------------------------------
--EnableAimbot
----------------------------------------------------------------------------------------
ButtonAimbot.MouseButton1Click:Connect(function()
	settings.AimbotEnabled = not settings.AimbotEnabled
end)
----------------------------------------------------------------------------------------
--VisibleAimbot
----------------------------------------------------------------------------------------
local function toggleElements()
	BoxFOV.Visible = not BoxFOV.Visible
	BoxSmooth.Visible = not BoxSmooth.Visible
	ButtonTeamCheck.Visible = not ButtonTeamCheck.Visible
	ButtonRay.Visible = not ButtonRay.Visible
end

ButtonAimbot.MouseButton1Click:Connect(toggleElements)
-------------------------------------------------------------------------------------------------
--ClickButtonAimbotUseRayWithIgnoreList
-------------------------------------------------------------------------------------------------
ButtonRay.MouseButton1Click:Connect(function()
	settings.UseRayWithIgnoreList = not settings.UseRayWithIgnoreList
end)
-------------------------------------------------------------------------------------------------
--ClickButtonColor ButtonAimbot
-------------------------------------------------------------------------------------------------
local isToggled = false -- Variable pour suivre l'état du bouton

ButtonAimbot.MouseButton1Click:Connect(function()
	if isToggled then
		-- Si le bouton est déjà activé, rétablissez les paramètres d'origine
		ButtonAimbot.BorderSizePixel = 0
		ButtonAimbot.BorderColor3 = Color3.fromRGB(107, 46, 3)
		isToggled = false
	else
		-- Si le bouton n'est pas activé, changez la BorderSizePixel et la BorderColor3
		ButtonAimbot.BorderSizePixel = 2.5
		ButtonAimbot.BorderColor3 = Color3.new(1, 1, 1)
		isToggled = true
	end
end)
-------------------------------------------------------------------------------------------------
--ClickButtonColor ButtonAimbot
-------------------------------------------------------------------------------------------------
local isToggled = false -- Variable pour suivre l'état du bouton

ButtonTeamCheck.MouseButton1Click:Connect(function()
	if isToggled then
		-- Si le bouton est déjà activé, rétablissez les paramètres d'origine
		ButtonTeamCheck.BorderSizePixel = 0
		ButtonTeamCheck.BorderColor3 = Color3.fromRGB(107, 46, 3)
		isToggled = false
	else
		-- Si le bouton n'est pas activé, changez la BorderSizePixel et la BorderColor3
		ButtonTeamCheck.BorderSizePixel = 2.5
		ButtonTeamCheck.BorderColor3 = Color3.new(1, 1, 1)
		isToggled = true
	end
end)
-------------------------------------------------------------------------------------------------
--ClickButtonColor ButtonRay
-------------------------------------------------------------------------------------------------
local isToggled = false -- Variable pour suivre l'état du bouton

ButtonRay.MouseButton1Click:Connect(function()
	if isToggled then
		-- Si le bouton est déjà activé, rétablissez les paramètres d'origine
		ButtonRay.BorderSizePixel = 0
		ButtonRay.BorderColor3 = Color3.fromRGB(107, 46, 3)
		isToggled = false
	else
		-- Si le bouton n'est pas activé, changez la BorderSizePixel et la BorderColor3
		ButtonRay.BorderSizePixel = 2.5
		ButtonRay.BorderColor3 = Color3.new(1, 1, 1)
		isToggled = true
	end
end)
